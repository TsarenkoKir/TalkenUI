(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{1543:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ChatHome",function(){return n(3410)}])},7841:function(e,s,n){"use strict";n.d(s,{Z:function(){return u}});var r=n(5893),t=n(7294),a=n(8934),i=n(7568),c=n(7582),d=function(){var e=(0,t.useContext)(a.p),s=e.messagesList,n=e.selectedUserName,d=e.showMessages,l=e.selectedAddr,u=e.messageInput,o=e.setMessageInput,h=e.sendMessage,m=(0,t.useState)(!1),x=m[0],f=m[1];(0,t.useEffect)((function(){l&&(f(!0),d(l).finally((function(){f(!1)})))}),[l]);!function(){var e=(0,i.Z)((function(){var e;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:if(!u.trim())return alert("Message cannot be empty!"),[2];s.label=1;case 1:return s.trys.push([1,3,4,5]),f(!0),[4,h(l)];case 2:return s.sent(),o(""),[3,5];case 3:return e=s.sent(),console.error("Failed to send message:",e),alert("Failed to send message. Please try again."),[3,5];case 4:return f(!1),[7];case 5:return[2]}}))}))}();return l?(0,r.jsxs)("div",{className:"messages",children:[(0,r.jsx)("div",{className:"message-header",children:(0,r.jsxs)("h3",{children:["Chat with ",n||"Unknown User"]})}),(0,r.jsx)("div",{className:"message-list",children:x?(0,r.jsx)("p",{children:"Loading messages..."}):Array.isArray(s)&&s.length>0?s.map((function(e,s){var n=e.sender,t=e.msg,a=e.timestamp,i=isNaN(Number(a))?"Invalid time":new Date(1e3*Number(a)).toLocaleTimeString();return(0,r.jsxs)("div",{className:"message",children:[(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:["From: ",n]}),(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Message:"})," ",(0,r.jsx)("span",{children:t})]}),(0,r.jsx)("span",{children:i})]},s)})):(0,r.jsx)("p",{children:"No messages yet. Say hello!"})})]}):(0,r.jsx)("div",{className:"messages",children:(0,r.jsx)("p",{children:"Please select a friend to start a chat."})})},l=function(){var e=(0,t.useContext)(a.p),s=(e.setSearchAccount,e.searchAndAddFriend,e.setMessageInput),n=e.sendMessage,i=e.selectedAddr;return(0,r.jsxs)("div",{className:"input",children:[(0,r.jsx)("input",{required:!0,type:"text",placeholder:"Type something...",onChange:function(e){return s(e.target.value)}}),(0,r.jsx)("div",{className:"send",children:(0,r.jsx)("button",{onClick:function(){i?n(i):alert("No friend selected")},children:"Send"})})]})},u=function(){var e=(0,t.useContext)(a.p).selectedUserName;return(0,r.jsxs)("div",{className:"chat",children:[(0,r.jsx)("div",{className:"chatInfo",children:(0,r.jsx)("span",{children:e})}),(0,r.jsx)(d,{}),(0,r.jsx)(l,{})]})}},6577:function(e,s,n){"use strict";n.d(s,{Z:function(){return l}});var r=n(5893),t=n(7294),a=n(8934),i=function(){var e=(0,t.useContext)(a.p),s=(e.networkError,e.isUserLoggedIn,e.logoutUser);return(0,r.jsxs)("div",{className:"navbar",children:[(0,r.jsx)("span",{className:"logo",children:"DApp Chat"}),(0,r.jsx)("div",{className:"user",children:(0,r.jsx)("button",{onClick:s,children:"logout"})})]})},c=(n(1163),n(1664),function(){var e=(0,t.useContext)(a.p),s=e.setSearchAccount,n=e.searchAndAddFriend;return(0,r.jsx)("div",{className:"search",children:(0,r.jsx)("div",{className:"searchForm",children:(0,r.jsxs)("form",{onSubmit:n,children:[(0,r.jsx)("input",{required:!0,type:"text",placeholder:"Enter Address to Add Friend",onChange:function(e){return s(e.target.value)}}),(0,r.jsx)("button",{type:"submit",children:"Add"})]})})})}),d=function(){var e=(0,t.useContext)(a.p),s=e.friendsList,n=e.getMyFriendList,i=e.showMessages,c=e.setSelectedUserName,d=e.setSelectedAddr;return(0,t.useEffect)((function(){n()}),[n]),(0,r.jsx)("div",{className:"chats",children:Array.isArray(s)&&s.length>0?s.map((function(e,s){return(0,r.jsxs)("div",{className:"userChat",onClick:function(){i(e.pubkey),d(e.pubkey),c(e.name)},children:[(0,r.jsx)("img",{src:"https://png.pngitem.com/pimgs/s/130-1300253_female-user-icon-png-download-user-image-color.png",alt:"Friend Avatar"}),(0,r.jsx)("div",{className:"userChatInfo",children:(0,r.jsx)("span",{children:e.name})})]},e.pubkey||s)})):(0,r.jsx)("p",{children:"No friends found"})})},l=function(){return(0,r.jsxs)("div",{className:"sidebar",children:[(0,r.jsx)(i,{}),(0,r.jsx)(c,{}),(0,r.jsx)(d,{})]})}},3410:function(e,s,n){"use strict";n.r(s);var r=n(5893),t=n(7294),a=n(6577),i=n(7841),c=n(8934);s.default=function(){var e=(0,t.useContext)(c.p).connectWallet;return(0,t.useEffect)((function(){e()}),[]),(0,r.jsx)("div",{className:"home",children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)(a.Z,{}),(0,r.jsx)(i.Z,{})]})})}}},function(e){e.O(0,[664,774,888,179],(function(){return s=1543,e(e.s=s);var s}));var s=e.O();_N_E=s}]);